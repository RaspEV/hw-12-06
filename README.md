# Домашнее задание к занятию «Репликация и масштабирование. Часть 1» - Распутин Е.В.

---

### Задание 1

На лекции рассматривались режимы репликации master-slave, master-master, опишите их различия.

*Ответить в свободной форме.*

### Ответ к заданию 1:

Репликация master-slave подразумевает под собой схему, где есть один главный сервер и один или несколько подчинённых. 
Master -  основной сервер. Все операции записи происходят на нём (INSERT, UPDATE, DELETE)
Slave - копия мастера с ограниченными правами. Он получает изменения от мастера и может делать запросы на чтение (SELECT)

Устойчивость такой репликации не высока, т.к. если сервер Master  выйдет из строя, то система не сможет дальше работать.

В репликации Master-Master все серверы равноправны — каждый является одновременно и мастером, и слейвом для другого.
Запросы на запись или чтение можно отправлять на любой из серверов, и изменения будут распространены на все остальные.

Такая схема повышает отказоустойчивость: если один из мастеров выйдет из
строя, система продолжит работу, используя оставшиеся серверы

---

### Задание 2

Выполните конфигурацию master-slave репликации, примером можно пользоваться из лекции.

*Приложите скриншоты конфигурации, выполнения работы: состояния и режимы работы серверов.*


### Решение к заданию 2:

Выполнение через docker-compose файл по [ссылке](files/docker-compose.yml).

- Конфиг mysql-master по [ссылке my1.cnf](files/master/my1.cnf)
- Конфиг mysql-slave по [ссылке my2.cnf](files/slave/my2.cnf)

Подняты два контенера:
- mysql-master
- mysql-slave

Сеть между контейнерами "mysql-replication"

##### Контейнеры запущены
![Контейнеры запущены](images/img1.png)

Входим на сервер master и cоздаём пользователя для репликации:
```sql
CREATE USER 'repl_user'@'%' IDENTIFIED BY 'repl_password';
GRANT REPLICATION SLAVE ON *.* TO 'repl_user'@'%';
FLUSH PRIVILEGES;
```
Проверка статуса Master:
```sql
SHOW MASTER STATUS;
```
##### Проверка статуса Master
![Проверка статуса Master](images/img2.png)

Входим на сервер slave и настраевываем репликацию:
```sql
CHANGE MASTER TO
MASTER_HOST='mysql-master',
MASTER_USER='repl_user',
MASTER_PASSWORD='repl_password',
MASTER_LOG_FILE='mysql-bin.000003',
MASTER_LOG_POS=1322;
```
##### Проверка статуса Slave
![Проверка статуса Slave](images/img3.png)

